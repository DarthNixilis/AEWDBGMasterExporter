<!-- FILE: index.html -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AEW DBG Master Exporter</title>
  <link rel="stylesheet" href="./style.css" />
</head>

<body>
  <header style="padding:12px;border-bottom:1px solid #ddd;position:sticky;top:0;background:#fff;z-index:10;">
    <div style="font-size:22px;font-weight:900;">
      Card Pool <span style="color:#666;font-weight:600;">Deck Starting</span>
    </div>
    <div style="font-size:12px;color:#666;font-weight:700;">
      BUILD: 2026-01-05 / four-persona + deckbuilder UI
    </div>
    <div id="statusLine" style="font-size:14px;color:#222;">
      Status: Loading…  Sets: (loading)  Cards: (loading)
    </div>
  </header>

  <main style="padding:16px;max-width:980px;margin:0 auto;">
    <p style="color:#666;">
      If you can read the BUILD line above, your root <b>index.html</b> is being served correctly.
      If you cannot, GitHub Pages is publishing a different folder (usually <b>/docs</b>) or a different branch.
    </p>

    <div id="toastWrap" style="display:none;position:fixed;left:0;right:0;bottom:0;justify-content:center;padding:10px;z-index:9999;">
      <div style="width:min(620px,calc(100vw - 20px));background:#111;color:#fff;border-radius:14px;padding:12px;box-shadow:0 10px 40px rgba(0,0,0,.35);">
        <div style="display:flex;justify-content:space-between;align-items:center;gap:10px;">
          <div>
            <div id="toastTitle" style="font-weight:800;">App Error</div>
            <div id="toastTime" style="color:#bbb;font-size:12px;"></div>
          </div>
          <div style="display:flex;gap:8px;">
            <button id="toastCopyBtn" type="button" style="padding:8px 10px;border-radius:10px;border:0;">Copy</button>
            <button id="toastCloseBtn" type="button" style="padding:8px 10px;border-radius:10px;border:0;">Close</button>
          </div>
        </div>
        <pre id="toastBody" style="margin:10px 0 0;font-size:12px;white-space:pre-wrap;word-break:break-word;max-height:45vh;overflow:auto;"></pre>
      </div>
    </div>
  </main>

  <script>
    // FILE: index.html
    (function () {
      var statusLine = document.getElementById("statusLine");

      function setStatus(text) {
        if (statusLine) statusLine.textContent = text;
      }

      var toastWrap = document.getElementById("toastWrap");
      var toastTitle = document.getElementById("toastTitle");
      var toastTime = document.getElementById("toastTime");
      var toastBody = document.getElementById("toastBody");
      var toastCopyBtn = document.getElementById("toastCopyBtn");
      var toastCloseBtn = document.getElementById("toastCloseBtn");

      function showToast(title, body) {
        toastTitle.textContent = title || "App Error";
        toastTime.textContent = new Date().toLocaleTimeString();
        toastBody.textContent = body || "";
        toastWrap.style.display = "flex";

        toastCopyBtn.onclick = async function () {
          var text = toastTitle.textContent + "\n\n" + toastBody.textContent;
          try { await navigator.clipboard.writeText(text); } catch (e) {}
        };
        toastCloseBtn.onclick = function () { toastWrap.style.display = "none"; };
      }

      function showError(title, err) {
        var msg = err && err.stack ? err.stack : String(err || "");
        setStatus("Status: ERROR (see popup)  Sets: (?)  Cards: (?)");
        try { showToast(title || "App Error", msg); }
        catch (e) { alert((title || "App Error") + "\n\n" + msg); }
      }

      window.AEWDBG = { setStatus: setStatus, showError: showError };

      window.addEventListener("error", function (ev) {
        showError("Uncaught error", ev.error || ev.message || ev);
      });
      window.addEventListener("unhandledrejection", function (ev) {
        showError("Unhandled rejection", ev.reason || ev);
      });

      // Try to load the real app if it exists
      (async function () {
        setStatus("Status: Loading…  Sets: (loading)  Cards: (loading)");
        try {
          var mod = await import("./renderer.js");
          if (!mod || typeof mod.initApp !== "function") {
            throw new Error("renderer.js loaded, but did not export initApp()");
          }
          await mod.initApp();
        } catch (e) {
          showError("Boot failed (module load/import).", e);
        }
      })();
    })();
  </script>
</body>
</html>
